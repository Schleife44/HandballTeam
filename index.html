<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team-Tracker</title>
    <link rel="stylesheet" href="styles.css?v=2.8">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body>

    <!-- Mobile Menu Toggle Button -->
    <button id="mobileMenuBtn" class="mobile-menu-btn">☰</button>

    <!-- Sidebar Overlay -->
    <div id="sidebarOverlay" class="sidebar-overlay"></div>

    <!-- Sidebar Navigation -->
    <div id="sidebar">
        <div class="sidebar-header">
            <h2>HANDBALL<br>DASHBOARD</h2>
        </div>
        <nav class="sidebar-nav">
            <div class="nav-group-label">Basis</div>
            <div class="nav-item active" data-view="dashboard">
                <span class="nav-icon"><i data-lucide="layout-dashboard"></i></span>
                <span class="nav-label">Überblick</span>
            </div>
            <div class="nav-item" data-view="calendar">
                <span class="nav-icon"><i data-lucide="calendar"></i></span>
                <span class="nav-label">Kalender</span>
            </div>
            <div class="nav-item" data-view="tacticalboard">
                <span class="nav-icon"><i data-lucide="clipboard-list"></i></span>
                <span class="nav-label">Taktikboard</span>
            </div>

            <div class="nav-group-label">Spieltag</div>
            <div class="nav-item" data-view="game">
                <span class="nav-icon"><i data-lucide="play-circle"></i></span>
                <span class="nav-label">Spiel</span>
                <span id="sidebarTimer" class="sidebar-timer versteckt">00:00</span>
            </div>
            <div class="nav-item" data-view="roster">
                <span class="nav-icon"><i data-lucide="users"></i></span>
                <span class="nav-label">Kader</span>
            </div>

            <div class="nav-group-label">Live Analyse</div>
            <div class="nav-item" data-view="overview">
                <span class="nav-icon"><i data-lucide="bar-chart-2"></i></span>
                <span class="nav-label">Übersicht</span>
            </div>
            <div class="nav-item" data-view="shots">
                <span class="nav-icon"><i data-lucide="crosshair"></i></span>
                <span class="nav-label">Wurfbilder</span>
            </div>
            <div class="nav-item" data-view="heatmap">
                <span class="nav-icon"><i data-lucide="flame"></i></span>
                <span class="nav-label">Heatmap</span>
            </div>
            <div class="nav-item" data-view="protocol">
                <span class="nav-icon"><i data-lucide="list"></i></span>
                <span class="nav-label">Protokoll</span>
            </div>

            <div class="nav-group-label">Archiv</div>
            <div class="nav-item" data-view="history">
                <span class="nav-icon"><i data-lucide="history"></i></span>
                <span class="nav-label">Historie</span>
            </div>
            <div class="nav-item" data-view="videoanalyse">
                <span class="nav-icon"><i data-lucide="video"></i></span>
                <span class="nav-label">Video Analyse</span>
            </div>
            <div class="nav-item" data-view="seasonStats">
                <span class="nav-icon"><i data-lucide="bar-chart-2"></i></span>
                <span class="nav-label">Saison Statistiken</span>
            </div>

            <div class="nav-group-label">System</div>

            <div class="nav-item" data-view="settings">
                <span class="nav-icon"><i data-lucide="settings"></i></span>
                <span class="nav-label">Einstellungen</span>
            </div>
        </nav>
    </div>

    <!-- Main Content Area -->
    <div id="main-content">

        <!-- SECTION: CALENDAR -->
        <div id="calendarBereich" class="content-section versteckt">
            <div class="calendar-header">
                <div class="cal-nav">
                    <button id="prevMonthBtn" class="shadcn-btn-ghost">&lt;</button>
                    <h2 id="currentMonthLabel" style="min-width: 200px; text-align: center; margin: 0;">Januar 2026</h2>
                    <button id="nextMonthBtn" class="shadcn-btn-ghost">&gt;</button>
                </div>
                <div class="cal-actions">
                    <button id="manageCalendarBtn" class="shadcn-btn-outline" title="Kalender verwalten">
                        <i data-lucide="settings"></i> <span class="mobile-hidden">Verwalten</span>
                    </button>
                    <button id="addEventBtn" class="shadcn-btn-primary">
                        <i data-lucide="plus"></i> <span class="mobile-hidden">Termin</span>
                    </button>
                </div>
            </div>

            <div class="calendar-container">
                <div class="calendar-header-days">
                    <div>Mo</div>
                    <div>Di</div>
                    <div>Mi</div>
                    <div>Do</div>
                    <div>Fr</div>
                    <div>Sa</div>
                    <div>So</div>
                </div>

                <!-- MANAGE MODAL -->
                <div id="manageCalendarModal" class="event-popover versteckt"
                    style="width: 450px; height: auto; max-height: 80vh; overflow-y: auto;">
                    <div class="modal-header">
                        <h3>Kalender verwalten</h3>
                        <button id="closeManageBtn" class="close-btn">X</button>
                    </div>
                    <div class="modal-body" style="padding: 1rem; gap: 1.5rem; display: flex; flex-direction: column;">

                        <!-- SECTION: Add Subscription -->
                        <div class="manage-section">
                            <h4 style="font-size: 0.9rem; margin-bottom: 0.5rem; color: hsl(var(--foreground));">Neues
                                Abo hinzufügen</h4>
                            <div style="display: flex; gap: 8px;">
                                <input type="text" id="manageUrlInput" placeholder="https://... (ICS/Webcal)"
                                    class="shadcn-input" style="flex:1;" />
                                <button id="addSubBtn" class="shadcn-btn-primary">Hinzufügen</button>
                            </div>
                        </div>

                        <hr style="border: 0; border-top: 1px solid hsl(var(--border)); margin: 0;">

                        <!-- SECTION: Subscriptions -->
                        <div class="manage-section">
                            <h4 style="font-size: 0.9rem; margin-bottom: 0.5rem; color: hsl(var(--foreground));">
                                Abonnierte Kalender</h4>
                            <div id="subsList" class="manage-list"
                                style="font-size: 0.85rem; color: hsl(var(--muted-foreground));">
                                <!-- JS fills this -->
                                <div style="font-style: italic;">Keine Abos vorhanden.</div>
                            </div>
                        </div>

                        <hr style="border: 0; border-top: 1px solid hsl(var(--border)); margin: 0;">

                        <!-- SECTION: Series -->
                        <div class="manage-section">
                            <h4 style="font-size: 0.9rem; margin-bottom: 0.5rem; color: hsl(var(--foreground));">
                                Wiederholende Termine (Serien)</h4>
                            <div id="seriesList" class="manage-list"
                                style="font-size: 0.85rem; color: hsl(var(--muted-foreground));">
                                <!-- JS fills this -->
                                <div style="font-style: italic;">Keine Serien vorhanden.</div>
                            </div>
                        </div>

                    </div>
                </div>
                <div id="calendarGrid" class="calendar-grid">
                    <!-- Javascript generated days -->
                </div>
            </div>
        </div>

        <!-- SECTION: TACTICAL BOARD -->
        <div id="tacticalBoardBereich" class="content-section versteckt">
            <div class="section-header">
                <h1>Taktikboard</h1>
                <p class="text-muted">Entwirf und animiere deine Spielzüge</p>
            </div>
            <div id="tacticalBoardContainer" class="tactical-board-main">
                <!-- Content will be injected by tacticalBoardView.js -->
            </div>
        </div>

        <!-- POPOVER: Add/Edit Event -->
        <div id="addEventModal" class="event-popover versteckt" style="width: 350px;">
            <div class="modal-header">
                <h2 id="addEventModalTitle">Termin</h2>
                <div class="header-actions">
                    <button id="closeEventModal" class="icon-btn-ghost"><i data-lucide="x"></i></button>
                </div>
            </div>
            <div class="modal-body">
                <div class="form-section">
                    <input type="text" id="eventTitleInput" class="shadcn-input" placeholder="Titel hinzufügen"
                        style="font-size: 1.2rem; border:none; padding-left:0; border-bottom: 1px solidhsl(var(--border)); border-radius:0;">
                </div>

                <div class="form-section" style="margin-top: 10px;">
                    <div class="radio-pill-group">
                        <label class="radio-pill training">
                            <input type="radio" name="eventType" value="training" checked>
                            <span>Training</span>
                        </label>
                        <label class="radio-pill game">
                            <input type="radio" name="eventType" value="game">
                            <span>Spiel</span>
                        </label>
                        <label class="radio-pill other">
                            <input type="radio" name="eventType" value="other">
                            <span>Sonstiges</span>
                        </label>
                    </div>
                </div>

                <div class="form-section">
                    <div class="form-row-2">
                        <div class="input-group">
                            <div class="details-row" style="border:none; padding:0;">
                                <span class="details-icon"><i data-lucide="calendar"></i></span>
                                <input type="date" id="eventDateInput" class="shadcn-input"
                                    style="border:none; padding-left: 0;">
                            </div>
                        </div>
                        <div class="input-group">
                            <div class="details-row" style="border:none; padding:0;">
                                <span class="details-icon"><i data-lucide="clock"></i></span>
                                <input type="time" id="eventTimeInput" class="shadcn-input"
                                    style="border:none; padding-left: 0;" step="900">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <div class="details-row" style="border:none; padding:0;">
                        <span class="details-icon"><i data-lucide="map-pin"></i></span>
                        <input type="text" id="eventLocationInput" class="shadcn-input" placeholder="Ort hinzufügen"
                            style="border:none;">
                    </div>
                </div>

                <div class="form-section recurrence-section">
                    <label class="checkbox-wrapper">
                        <input type="checkbox" id="eventRepeatInput">
                        <span class="checkbox-label">Wöchentlich</span>
                    </label>

                    <div id="recurrenceOptions" class="recurrence-options versteckt">
                        <label style="font-size:0.8rem;">Bis:</label>
                        <input type="date" id="eventRepeatEndInput" class="shadcn-input">
                    </div>
                </div>

                <div class="modal-actions">
                    <button id="saveEventBtn" class="shadcn-btn-primary" style="margin-left: auto;">Speichern</button>
                </div>
            </div>
        </div>

        <!-- POPOVER: Event Details -->
        <div id="eventDetailsModal" class="event-popover versteckt">
            <div class="modal-header">
                <h2 id="detailsTitle">Training</h2>
                <div class="header-actions">
                    <button id="editEventBtn" class="icon-btn-ghost" title="Bearbeiten"><i
                            data-lucide="pencil"></i></button>
                    <button id="closeDetailsModal" class="icon-btn-ghost" title="Schließen"><i
                            data-lucide="x"></i></button>
                </div>
            </div>
            <div class="modal-body">
                <div class="details-row">
                    <span class="details-icon"><i data-lucide="calendar"></i></span>
                    <span id="detailsDate">Dienstag, 12.03.2024</span>
                </div>
                <div class="details-row">
                    <span class="details-icon"><i data-lucide="clock"></i></span>
                    <span id="detailsTime">19:00 Uhr</span>
                </div>
                <div class="details-row" id="detailsLocationRow">
                    <span class="details-icon"><i data-lucide="map-pin"></i></span>
                    <span id="detailsLocation">Halle Bösperde</span>
                </div>

                <div class="modal-actions">
                    <button id="deleteEventBtn" class="shadcn-btn-destructive" title="Löschen"><i data-lucide="trash-2"
                            style="width:16px;"></i></button>
                    <!-- Close button in header is enough, or we keep a discrete close/edit here -->
                </div>
            </div>
        </div>

        <div id="rosterBereich" class="content-section versteckt">
            <!-- Roster Top Section -->
            <div class="roster-top-section">
                <!-- Team Namen Eingabe -->
                <div class="roster-form-card" style="margin-bottom: 20px;">
                    <div class="roster-form-grid"
                        style="grid-template-columns: 1fr auto 1fr; align-items: end; gap: 15px;">
                        <div class="roster-input-group">
                            <label for="rosterTeamNameHeim">Heim Team Name</label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <div style="position: relative; flex: 1;">
                                    <input type="text" id="rosterTeamNameHeim" placeholder="Heim Team"
                                        style="width: 100%; padding-right: 30px;">
                                    <i id="rosterHeimLockIcon" data-lucide="lock"
                                        style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); width: 16px; height: 16px; color: #64748b; display: none;"></i>
                                </div>
                                <div class="color-picker-wrapper" title="Trikotfarbe wählen"
                                    style="position: relative; cursor: pointer;">
                                    <button id="teamColorTrigger" class="shadcn-btn-outline"
                                        style="width: 36px; height: 36px; padding: 0; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                                        <i data-lucide="shirt" style="width: 20px; height: 20px;"></i>
                                    </button>
                                    <input type="color" id="teamColorInput" value="#dc3545"
                                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;">
                                </div>
                            </div>
                        </div>

                        <button id="rosterSwapTeamsBtn" class="shadcn-btn-outline" title="Seiten wechseln"
                            style="margin-bottom: 2px; height: 36px; width: 36px; padding: 0; display: flex; align-items: center; justify-content: center;">
                            <i data-lucide="arrow-left-right" style="width: 20px; height: 20px;"></i>
                        </button>

                        <div class="roster-input-group">
                            <label for="rosterTeamNameGegner">Gast Team Name</label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <div style="position: relative; flex: 1;">
                                    <input type="text" id="rosterTeamNameGegner" placeholder="Gast Team"
                                        style="width: 100%; padding-right: 30px;">
                                    <i id="rosterGegnerLockIcon" data-lucide="lock"
                                        style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); width: 16px; height: 16px; color: #64748b; display: none;"></i>
                                </div>
                                <div class="color-picker-wrapper" title="Trikotfarbe wählen"
                                    style="position: relative; cursor: pointer;">
                                    <button id="teamColorTriggerGegner" class="shadcn-btn-outline"
                                        style="width: 36px; height: 36px; padding: 0; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                                        <div class="lock-icon-container">
                                            <i data-lucide="shirt" style="width: 20px; height: 20px;"></i>
                                        </div>
                                    </button>
                                    <input type="color" id="teamColorInputGegner" value="#2563eb"
                                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add Player Card -->
                <div class="roster-form-card" style="padding: 1rem;">
                    <div class="roster-form-header" style="margin-bottom: 1rem;">
                        <h2 style="margin:0; font-size: 1.2rem;">Kader verwalten</h2>
                    </div>
                    <!-- Compact Form - Single Row -->
                    <form id="addPlayerForm" style="display: flex; gap: 10px; align-items: flex-end;">
                        <input type="hidden" id="editPlayerIndex">
                        <div style="flex: 2;">
                            <label for="playerNameInput"
                                style="font-size: 0.8rem; display: block; margin-bottom: 4px;">Name</label>
                            <input type="text" id="playerNameInput" class="shadcn-input" placeholder="Spielername">
                        </div>
                        <div style="flex: 1; min-width: 70px;">
                            <label for="playerNumberInput"
                                style="font-size: 0.8rem; display: block; margin-bottom: 4px;">Nummer</label>
                            <input type="number" id="playerNumberInput" class="shadcn-input" placeholder="#" min="1"
                                max="99">
                        </div>
                        <div style="flex: 0 0 auto; min-width: 50px;">
                            <label for="playerTorwartInput"
                                style="font-size: 0.8rem; display: block; margin-bottom: 4px; text-align: center;">TW</label>
                            <div
                                style="height: 40px; display: flex; align-items: center; justify-content: center; border: 1px solid var(--border-color); border-radius: 6px; background: var(--bg-card);">
                                <input type="checkbox" id="playerTorwartInput"
                                    style="width: 18px; height: 18px; cursor: pointer; accent-color: var(--btn-primary);">
                            </div>
                        </div>
                        <div>
                            <button type="submit" class="shadcn-btn-white" style="height: 40px;">Hinzufügen</button>
                            <button type="button" id="cancelEditButton" class="shadcn-btn-outline versteckt"
                                style="height: 40px;">Abbrechen</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- Roster Bottom Section -->
            <div class="roster-bottom-section">
                <!-- Team Management Actions -->
                <div class="roster-manage-grid">
                    <button id="exportTeamButton" class="shadcn-btn-outline">Team exportieren</button>
                    <button id="importTeamButton" class="shadcn-btn-outline">Team importieren</button>
                    <input type="file" id="importFileInput" class="versteckt" accept=".json">
                    <button id="saveTeamButton" class="shadcn-btn-outline"
                        style="border-color: #22c55e; color: #22c55e;">
                        Team speichern</button>
                    <button id="loadTeamButton" class="shadcn-btn-outline"
                        style="border-color: #3b82f6; color: #3b82f6;">
                        Team laden</button>
                </div>

                <!-- Roster List Header -->
                <div
                    style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 0 10px;">
                    <h2 id="teamHeaderTitle" style="margin: 0; font-size: 1.6rem; font-weight: 800;">Heim Team</h2>
                    <div
                        style="display: flex; align-items: center; gap: 12px; background: var(--bg-card); padding: 8px 15px; border-radius: 12px; border: 1px solid var(--border-color);">
                        <span style="font-size: 0.85rem; font-weight: 600; color: var(--text-muted);">HEIM</span>
                        <button id="teamToggle" role="switch" aria-checked="false" data-state="unchecked"
                            class="shadcn-switch">
                            <span class="shadcn-switch-thumb"></span>
                        </button>
                        <span style="font-size: 0.85rem; font-weight: 600; color: var(--text-muted);">GAST</span>
                    </div>
                </div>

                <!-- Player Cards Grid -->
                <div id="rosterListe" class="roster-grid"></div>

                <!-- Danger Zone -->
                <div style="margin-top: 40px; border-top: 1px solid var(--border-color); padding-top: 20px;">
                    <button id="deleteTeamButton" class="shadcn-btn-outline roster-delete-btn"
                        style="width: 100%; max-width: 300px; margin: 0 auto; height: 44px;">Aktuelles Team
                        löschen</button>
                </div>
            </div>
        </div>

        <!-- Live Overview Page Section -->
        <div id="liveOverviewBereich" class="content-section versteckt">
            <div id="liveOverviewContent"></div>
        </div>

        <!-- Season Overview Page Section (Legacy/Table) -->
        <div id="seasonBereich" class="content-section versteckt">
            <h2>Saison</h2>
            <div id="seasonContent">
                <p>Hier könnte die Spielplan-Übersicht oder Tabelle stehen.</p>
            </div>
        </div>

        <!-- Season Stats Page Section (New) -->
        <div id="seasonStatsBereich" class="content-section versteckt">
            <h2>Saison Statistiken</h2>

            <!-- 4-Button Sub-Tab Navigation -->
            <div class="season-subtab-nav" style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                <button class="season-subtab-btn shadcn-btn-primary" data-subtab="stats">Saison Statistiken</button>
                <button class="season-subtab-btn shadcn-btn-outline" data-subtab="players">Spieler Statistiken</button>
                <button class="season-subtab-btn shadcn-btn-outline" data-subtab="heatmap">Saison Heatmap</button>
                <button class="season-subtab-btn shadcn-btn-outline" data-subtab="diagramm">Saison Diagramm</button>
            </div>

            <!-- Sub-Tab 1: Saison Statistiken (Current Team Stats) -->
            <div id="seasonStatsTab" class="season-subtab-content">
                <div id="seasonSummary" class="season-summary-grid-container" style="margin-bottom: 2rem;">
                    <!-- JS Populated -->
                </div>

                <div id="seasonStatsContainer" class="season-stats-main-container">
                    <!-- JS Populated (Player Cards) -->
                </div>
            </div>

            <!-- Sub-Tab 2: Spieler Statistiken (Player Roster Table) -->
            <div id="seasonPlayersTab" class="season-subtab-content versteckt">
                <div id="playerStatsListContainer">
                    <!-- JS Populated (will be moved from seasonView.js) -->
                </div>
            </div>

            <!-- Sub-Tab 3: Saison Heatmap -->
            <div id="seasonHeatmapTab" class="season-subtab-content versteckt">
                <!-- Content will be populated by heatmap.js when this tab is selected -->
                <div id="subtabSeasonHeatmapContainer">
                    <!-- Heatmap content -->
                </div>
            </div>

            <!-- Sub-Tab 4: Saison Diagramm (Team Comparison) -->
            <div id="seasonDiagrammTab" class="season-subtab-content versteckt">
                <div id="subtabSeasonDiagrammContent">
                    <!-- Team diagram content -->
                </div>
            </div>
        </div>

        <!-- Shot Charts Page Section -->
        <div id="shotsBereich" class="content-section versteckt">
            <h2>Wurfbilder</h2>
            <div id="shotsContent"></div>
        </div>

        <!-- Live Heatmap Page Section -->
        <div id="liveHeatmapBereich" class="content-section versteckt">
            <div class="heatmap-view-container">
                <div class="heatmap-view-header">
                    <h1>Live Heatmap-Analyse</h1>
                </div>

                <div class="heatmap-controls-card">
                    <!-- Row 1: Selects -->
                    <div class="heatmap-row">
                        <div class="roster-input-group">
                            <label>Team</label>
                            <div
                                style="display: flex; align-items: center; gap: 12px; height: 40px; background: hsl(var(--muted)/0.3); padding: 0 15px; border-radius: 8px; border: 1px solid hsl(var(--border)); width: fit-content;">
                                <span id="heatmapHeimLabel"
                                    style="font-size: 0.85rem; font-weight: 600; color: hsl(var(--muted-foreground));">HEIM</span>
                                <button id="heatmapTeamToggle" role="switch" aria-checked="false" data-state="unchecked"
                                    class="shadcn-switch">
                                    <span class="shadcn-switch-thumb"></span>
                                </button>
                                <span id="heatmapGegnerLabel"
                                    style="font-size: 0.85rem; font-weight: 600; color: hsl(var(--muted-foreground));">GAST</span>
                            </div>
                        </div>
                        <div class="roster-input-group">
                            <label>Spieler</label>
                            <select id="heatmapPlayerSelect" class="shadcn-input shadcn-select-native">
                                <option value="all">Alle Spieler</option>
                            </select>
                        </div>
                    </div>

                    <!-- Row 2: Tabs -->
                    <div class="heatmap-tabs-row">
                        <button class="heatmap-tab white-style active" data-tab="tor">Tor-Ansicht</button>
                        <button class="heatmap-tab white-style" data-tab="feld">Wurf-Positionen</button>
                        <button class="heatmap-tab white-style" data-tab="kombiniert">Kombiniert</button>
                    </div>

                    <!-- Row 3: Filters -->
                    <div class="heatmap-filters-row">
                        <label class="heatmap-filter-item">
                            <input type="checkbox" id="heatmapToreFilter" checked> Feldtore
                        </label>
                        <label class="heatmap-filter-item">
                            <input type="checkbox" id="heatmap7mFilter"> 7m
                        </label>
                        <label class="heatmap-filter-item">
                            <input type="checkbox" id="heatmapMissedFilter" checked> Fehlwürfe
                        </label>
                    </div>
                </div>

                <div class="heatmap-visual-container">
                    <svg id="heatmapSvg" viewBox="0 0 300 200" width="600" height="400"></svg>
                </div>
            </div>
        </div>

        <!-- Protocol Page Section -->
        <div id="protokollBereich" class="content-section versteckt">
            <div style="max-width: 1000px; margin: 0 auto; padding: 20px;">
                <h1>Spielprotokoll</h1>
                <div id="protokoll" class="protocol-card">
                    <div class="protocol-header">
                        <h3 class="player-card-title">Live Ticker</h3>
                    </div>
                    <div id="protokollAusgabe"></div>
                </div>
            </div>
        </div>

        <!-- Export Page Section -->
        <div id="exportBereich" class="versteckt">
            <h2>Export</h2>
            <div id="exportContent" style="padding: 20px;"></div>
        </div>

        <!-- Settings Page Section -->
        <div id="settingsBereich" class="versteckt">
            <div style="padding: 20px; max-width: 800px; margin: 0 auto;">
                <h2>Einstellungen</h2>

                <div
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">


                    <!-- Card 2: General Settings -->
                    <div class="settings-card"
                        style="background: var(--bg-container); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                        <h4
                            style="margin-top: 0; margin-bottom: 15px; border-bottom: 2px solid var(--btn-purple); padding-bottom: 10px; display: inline-block;">
                            Allgemein</h4>
                        <div class="setting-row"
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <label for="toggleDarkMode" style="cursor: pointer;">Dark Mode</label>
                            <label class="switch">
                                <input type="checkbox" id="toggleDarkMode">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="setting-row" style="display: flex; flex-direction: column; gap: 8px;">
                            <label for="myTeamNameInput" style="font-weight: 500;">Mein Team Name:</label>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <input type="text" id="myTeamNameInput" placeholder="Mein Team" class="shadcn-input"
                                    style="flex: 1;">
                                <div class="color-picker-wrapper" title="Team Farbe wählen"
                                    style="position: relative; cursor: pointer;">
                                    <button id="myTeamColorTrigger" class="shadcn-btn-outline"
                                        style="width: 40px; height: 40px; padding: 0; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                                        <i id="myTeamColorIcon" data-lucide="shirt"
                                            style="width: 20px; height: 20px; color: #dc3545;"></i>
                                    </button>
                                    <input type="color" id="myTeamColorInput" value="#dc3545"
                                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer;">
                                </div>
                                <button id="toggleValidationBtn" class="shadcn-btn-outline"
                                    title="Einstellungen sperren/entsperren"
                                    style="width: 40px; height: 40px; padding: 0; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
                                    <div class="lock-icon-container">
                                        <i id="iconLocked" class="lock-icon hidden" data-lucide="lock"
                                            style="color: #22c55e;"></i>
                                        <i id="iconUnlocked" class="lock-icon visible" data-lucide="lock-open"
                                            style="color: #9ca3af;"></i>
                                    </div>
                                </button>
                            </div>
                        </div>
                        <div id="settingsValidatedIndicator" class="versteckt"
                            style="margin-top: 10px; padding: 10px; background: #22c55e20; border: 1px solid #22c55e; border-radius: 8px; display: flex; align-items: center; gap: 8px; color: #22c55e;">
                            <i data-lucide="check-circle" style="width: 16px; height: 16px;"></i>
                            <span>Einstellungen sind im Kader gespeichert</span>
                        </div>
                    </div>
                </div>



                <!-- Card 4: Wurfbilder -->
                <div class="settings-card"
                    style="background: var(--bg-container); padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                    <h4
                        style="margin-top: 0; margin-bottom: 15px; border-bottom: 2px solid var(--btn-danger); padding-bottom: 10px; display: inline-block;">
                        Wurfbilder (Popups)</h4>
                    <div style="display: flex; flex-direction: column; gap: 12px;">
                        <div class="setting-row"
                            style="display: flex; justify-content: space-between; align-items: center;">
                            <label for="toggleWurfbildHeim" style="cursor: pointer;">Wurfbild: Heim</label>
                            <label class="switch">
                                <input type="checkbox" id="toggleWurfbildHeim">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="setting-row"
                            style="display: flex; justify-content: space-between; align-items: center;">
                            <label for="toggleWurfbildGegner" style="cursor: pointer;">Wurfbild:
                                Gast</label>
                            <label class="switch">
                                <input type="checkbox" id="toggleWurfbildGegner">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div style="height: 1px; background: var(--border-color); margin: 5px 0;"></div>
                        <div class="setting-row"
                            style="display: flex; justify-content: space-between; align-items: center;">
                            <label for="toggleWurfpositionHeim" style="cursor: pointer;">Position:
                                Heim</label>
                            <label class="switch">
                                <input type="checkbox" id="toggleWurfpositionHeim">
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="setting-row"
                            style="display: flex; justify-content: space-between; align-items: center;">
                            <label for="toggleWurfpositionGegner" style="cursor: pointer;">Position:
                                Gast</label>
                            <label class="switch">
                                <input type="checkbox" id="toggleWurfpositionGegner">
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="spielBereich" class="content-section versteckt"
            style="padding: 0; background: transparent; border: none; box-shadow: none;">
            <!-- Mode Selection UI -->
            <div id="gameModeSelection"
                style="flex-direction: column; align-items: center; justify-content: center; height: 100%; min-height: 400px; gap: 30px;">
                <div style="text-align: center;">
                    <h2 style="font-size: 1.8rem; margin-bottom: 10px;">Spiel starten</h2>
                    <p style="color: var(--text-muted);">Wähle deine Ansicht für dieses Spiel</p>
                </div>

                <div style="display: flex; gap: 20px; flex-wrap: wrap; justify-content: center;">
                    <!-- Complex Option -->
                    <div id="btnSelectComplex" class="mode-selection-card"
                        style="width: 250px; padding: 25px; display: flex; flex-direction: column; align-items: center; gap: 15px; cursor: pointer;">
                        <div
                            style="width: 60px; height: 60px; background: rgba(var(--primary-rgb), 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <i data-lucide="layout-dashboard"
                                style="width: 32px; height: 32px; color: var(--primary);"></i>
                        </div>
                        <div style="text-align: center;">
                            <h3 style="margin: 0; margin-bottom: 5px;">Komplex</h3>
                            <p style="margin: 0; font-size: 0.9rem; color: var(--text-muted);">Dashboard & Bank</p>
                        </div>
                        <ul
                            style="text-align: left; font-size: 0.8rem; color: var(--text-muted); padding-left: 20px; margin: 0;">
                            <li>Vollständige Kontrolle</li>
                            <li>Bank verwalten</li>
                            <li>Inline-Aktionen</li>
                        </ul>
                    </div>

                    <!-- Simple Option -->
                    <div id="btnSelectSimple" class="mode-selection-card"
                        style="width: 250px; padding: 25px; display: flex; flex-direction: column; align-items: center; gap: 15px; cursor: pointer;">
                        <div
                            style="width: 60px; height: 60px; background: rgba(var(--primary-rgb), 0.1); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <i data-lucide="mouse-pointer-2"
                                style="width: 32px; height: 32px; color: var(--primary);"></i>
                        </div>
                        <div style="text-align: center;">
                            <h3 style="margin: 0; margin-bottom: 5px;">Einfach</h3>
                            <p style="margin: 0; font-size: 0.9rem; color: var(--text-muted);">Klassisch (Popups)</p>
                        </div>
                        <ul
                            style="text-align: left; font-size: 0.8rem; color: var(--text-muted); padding-left: 20px; margin: 0;">
                            <li>Fokus auf Spieler</li>
                            <li>Keine Bank</li>
                            <li>Modal-Fenster</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Actual Game Content (Hidden initially) -->
            <div id="gameContent" class="versteckt">
                <div class="game-split-view">
                    <!-- LEFT COLUMN: PLAYER ROSTER (Both Teams Side by Side) -->
                    <div class="game-roster-column">
                        <div class="dual-team-roster">
                            <!-- HEIM TEAM -->
                            <div class="team-roster-panel" id="heimTeamPanel">
                                <h3 class="team-panel-title" id="heimPanelTitle">HEIM</h3>

                                <!-- Goalkeeper -->
                                <div class="roster-section">
                                    <h4 class="roster-section-title">TORWART</h4>
                                    <div id="heimGoalkeeperRoster" class="game-player-grid compact-grid">
                                        <!-- GK injected by JS -->
                                    </div>
                                </div>

                                <!-- Field Players -->
                                <div class="roster-section">
                                    <h4 class="roster-section-title">FELDSPIELER</h4>
                                    <div id="heimActiveRoster" class="game-player-grid compact-grid">
                                        <!-- Players injected by JS -->
                                    </div>
                                </div>

                                <!-- Bench Players -->
                                <div class="roster-section">
                                    <h4 class="roster-section-title">BANK</h4>
                                    <div id="heimBenchRoster" class="game-player-grid compact-grid">
                                        <!-- Bench injected by JS -->
                                    </div>
                                </div>
                            </div>

                            <!-- GAST TEAM -->
                            <div class="team-roster-panel" id="gastTeamPanel">
                                <h3 class="team-panel-title" id="gastPanelTitle">GAST</h3>

                                <!-- Goalkeeper -->
                                <div class="roster-section">
                                    <h4 class="roster-section-title">TORWART</h4>
                                    <div id="gastGoalkeeperRoster" class="game-player-grid compact-grid">
                                        <!-- GK injected by JS -->
                                    </div>
                                </div>

                                <!-- Field Players -->
                                <div class="roster-section">
                                    <h4 class="roster-section-title">FELDSPIELER</h4>
                                    <div id="gastActiveRoster" class="game-player-grid compact-grid">
                                        <!-- Players injected by JS -->
                                    </div>
                                </div>

                                <!-- Bench Players -->
                                <div class="roster-section">
                                    <h4 class="roster-section-title">BANK</h4>
                                    <div id="gastBenchRoster" class="game-player-grid compact-grid">
                                        <!-- Bench injected by JS -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- RIGHT COLUMN: CONTROLS & ACTIONS -->
                    <div class="game-controls-column">
                        <!-- 1. Top Bar: Score & Timer (Reduced size) -->
                        <div class="game-top-bar">
                            <div id="timerContainer" class="compact-scoreboard">
                                <div id="timerAnzeige" class="compact-timer">00:00</div>

                                <div class="compact-score-display">
                                    <!-- HEIM WRAPPER -->
                                    <div class="score-team-wrapper heim">
                                        <span id="teamNameHeimDisplay" class="compact-team-name">HEIM</span>
                                        <div class="score-control-group">
                                            <button class="score-adjust-btn plus hidden" data-team="heim"
                                                data-delta="1">+</button>
                                            <span id="scoreAnzeige" class="compact-score">0</span>
                                            <button class="score-adjust-btn minus hidden" data-team="heim"
                                                data-delta="-1">-</button>
                                        </div>
                                    </div>

                                    <span class="compact-divider">:</span>

                                    <!-- GAST WRAPPER -->
                                    <div class="score-team-wrapper gast">
                                        <span id="teamNameGegnerDisplay" class="compact-team-name">GAST</span>
                                        <div class="score-control-group">
                                            <button class="score-adjust-btn plus hidden" data-team="gegner"
                                                data-delta="1">+</button>
                                            <span id="scoreAnzeigeGegner" class="compact-score">0</span>
                                            <button class="score-adjust-btn minus hidden" data-team="gegner"
                                                data-delta="-1">-</button>
                                        </div>
                                    </div>
                                </div>
                                <div id="suspensionContainer" class="compact-suspensions"></div>
                            </div>
                            <div class="game-phase-controls">
                                <button id="zurueckButton" class="shadcn-btn-ghost compact-btn" title="-30s"
                                    style="padding: 4px 8px; font-size: 0.8rem;">-30s</button>
                                <button id="gamePhaseButton" class="shadcn-btn-red">Start</button>
                                <button id="pauseButton" class="shadcn-btn-outline versteckt">Pause</button>
                                <button id="vorButton" class="shadcn-btn-ghost compact-btn" title="+30s"
                                    style="padding: 4px 8px; font-size: 0.8rem;">+30s</button>
                            </div>
                        </div>

                        <!-- 2. Action Dashboard -->
                        <div id="actionDashboard" class="action-dashboard-card disabled">
                            <div class="action-header">
                                <span id="selectedPlayerName">Wähle einen Spieler...</span>
                                <button id="closeActionDashboard" class="close-modal-x"
                                    title="Schließen">&times;</button>
                            </div>

                            <!-- RESULT Section -->
                            <div class="action-section">
                                <h4 class="action-section-title">ERGEBNIS</h4>
                                <div class="action-buttons-row">
                                    <button class="action-btn btn-goal" data-action="Tor">TOR</button>
                                    <button class="action-btn btn-save" data-action="Gehalten"
                                        id="actionParadeBtn">GEHALTEN</button>
                                    <button class="action-btn btn-post" data-action="Fehlwurf">FEHLWURF</button>
                                    <button class="action-btn btn-lost" data-action="Block">GEBLOCKT</button>
                                </div>
                            </div>

                            <!-- ACTIONS Section -->
                            <div class="action-section">
                                <h4 class="action-section-title">AKTIONEN</h4>
                                <div class="action-buttons-row">
                                    <button class="action-btn btn-outline" data-action="Foul">STÜRMERFOUL</button>
                                    <button class="action-btn btn-outline"
                                        data-action="Ballverlust">BALLVERLUST</button>
                                </div>
                                <div class="action-buttons-row">
                                    <button class="action-btn btn-outline" data-action="2min Provoziert">2 MIN
                                        HERAUSGEHOLT</button>
                                    <button class="action-btn btn-outline" data-action="7m Provoziert">7m
                                        HERAUSGEHOLT</button>
                                    <button class="action-btn btn-outline" data-action="1und1">1 v 1 GEWONNEN</button>
                                    <button class="action-btn btn-outline" data-action="7m+2min">7m + 2 MIN</button>
                                </div>
                            </div>

                            <!-- SUSPENSIONS Section -->
                            <div class="action-section">
                                <h4 class="action-section-title">STRAFEN</h4>
                                <div class="action-buttons-row">
                                    <button class="action-btn btn-2min" data-action="2 Minuten">2 MIN</button>
                                    <button class="action-btn btn-yellow" data-action="Gelbe Karte">GELBE KARTE</button>
                                    <button class="action-btn btn-red" data-action="Rote Karte">ROTE KARTE</button>
                                    <button class="action-btn btn-blue" data-action="Blaue Karte">BLAUE KARTE</button>
                                </div>
                            </div>
                        </div>

                        <!-- 3. Bottom Controls -->
                        <div class="game-bottom-controls">
                            <button id="undoButton" class="shadcn-btn-outline" title="Letzte Aktion rückgängig"
                                onclick="undoLastAction()">
                                <i data-lucide="undo-2" style="width: 16px; height: 16px; margin-right: 5px;"></i>
                                Rückgängig
                            </button>
                            <button id="spielBeendenButton" class="shadcn-btn-outline">Spiel beenden</button>
                        </div>

                    </div>
                </div> <!-- End game-split-view -->
            </div> <!-- End gameContent -->
        </div> <!-- End spielBereich -->

        <!-- Vergangene Spiele -->
        <div id="historieBereich" class="versteckt">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h1>Vergangene Spiele</h1>
                <!-- Back button removed -->
            </div>

            <div id="historieListe" class="history-list">
                <p>Keine gespeicherten Spiele.</p>
            </div>

            <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                <button id="importSpielButton" class="shadcn-btn-primary">Spiel importieren</button>
                <input type="file" id="importSpielInput" class="versteckt" accept=".json">
                <button id="exportHistorieButton" class="shadcn-btn-outline">Alle Spiele exportieren (Backup)</button>
            </div>
        </div>

        <!-- Vergangene Spiele Deitail -->
        <div id="historieDetailBereich" class="versteckt">
            <button id="backToHistoryList" class="shadcn-btn-outline">Zurück zur Liste</button>

            <!-- The header is now dynamically managed in historyView.js via a 'score-card' to match live overview -->
            <div id="historieHeader" class="versteckt"></div>

            <div class="heatmap-tabs">
                <button class="heatmap-tab shadcn-btn-outline active" id="histTabHeatmap">Heatmap</button>
                <button class="heatmap-tab shadcn-btn-outline" id="histTabProtokoll">Protokoll</button>
                <button class="heatmap-tab shadcn-btn-outline" id="histTabTorfolge">Torfolge</button>
            </div>


            <!-- Detail: Heatmap -->
            <div id="histContentHeatmap" class="versteckt" style="text-align: center;">
                <div class="heatmap-tabs" style="margin-top: 10px;">
                    <button class="heatmap-tab shadcn-btn-outline active" id="histSubTabTor">Tor</button>
                    <button class="heatmap-tab shadcn-btn-outline" id="histSubTabFeld">Feld</button>
                    <button class="heatmap-tab shadcn-btn-outline" id="histSubTabKombi">Kombiniert</button>
                </div>
                <div class="heatmap-controls-card"
                    style="padding: 15px; margin-bottom: 15px; background: var(--bg-secondary); border-radius: 12px; border: 1px solid var(--border-color);">
                    <div style="display: flex; flex-wrap: wrap; gap: 15px; align-items: flex-end;">
                        <div class="roster-input-group" style="flex: 1; min-width: 150px;">
                            <label
                                style="display: block; font-size: 0.8rem; color: var(--text-muted); margin-bottom: 5px;">Team</label>
                            <div
                                style="display: flex; align-items: center; gap: 12px; height: 40px; background: hsl(var(--muted)/0.3); padding: 0 15px; border-radius: 8px; border: 1px solid hsl(var(--border)); width: fit-content;">
                                <span id="histHeatTeamLabelHeim"
                                    style="font-size: 0.85rem; font-weight: 600; color: hsl(var(--muted-foreground));">HEIM</span>
                                <button id="histHeatmapTeamToggle" role="switch" aria-checked="false"
                                    data-state="unchecked" class="shadcn-switch">
                                    <span class="shadcn-switch-thumb"></span>
                                </button>
                                <span id="histHeatTeamLabelGegner"
                                    style="font-size: 0.85rem; font-weight: 600; color: hsl(var(--muted-foreground));">GAST</span>
                            </div>
                        </div>

                        <div class="roster-input-group" style="flex: 1; min-width: 150px;">
                            <label
                                style="display: block; font-size: 0.8rem; color: var(--text-muted); margin-bottom: 5px;">Spieler</label>
                            <select id="histHeatmapPlayerSelect" class="shadcn-input shadcn-select-native"
                                style="width: 100%; height: 38px;">
                                <option value="all">Alle Spieler</option>
                            </select>
                        </div>

                        <div style="display: flex; gap: 12px; padding-bottom: 8px;">
                            <label class="heatmap-filter-item"
                                style="font-size: 0.85rem; display: flex; align-items: center; gap: 6px; cursor: pointer;">
                                <input type="checkbox" id="histHeatmapToreFilter" checked> Feldtore
                            </label>
                            <label class="heatmap-filter-item"
                                style="font-size: 0.85rem; display: flex; align-items: center; gap: 6px; cursor: pointer;">
                                <input type="checkbox" id="histHeatmap7mFilter"> 7m
                            </label>
                            <label class="heatmap-filter-item"
                                style="font-size: 0.85rem; display: flex; align-items: center; gap: 6px; cursor: pointer;">
                                <input type="checkbox" id="histHeatmapMissedFilter" checked> Fehlwürfe
                            </label>
                        </div>
                    </div>
                </div>
                <div id="histHeatmapContainer" style="display: flex; justify-content: center; padding: 20px;">
                    <svg id="histHeatmapSvg" viewBox="0 0 300 200" width="600" height="400"></svg>
                </div>

                <!-- Copied Statistics for Heatmap Tab -->
                <div id="histHeatmapStatsArea" class="versteckt" style="text-align: left; margin-top: 20px;">
                    <div class="stats-card"
                        style="background: var(--bg-card); border-radius: 12px; padding: 15px; border: 1px solid var(--border-color); margin-bottom: 20px;">
                        <h2 id="histHeatmapHomeTitle" class="card-title"
                            style="margin: 0 0 15px 0; font-size: 1.1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
                            Heim</h2>
                        <div class="table-container" style="overflow-x: auto;">
                            <table class="modern-stats-table" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="text-align: left; color: var(--text-muted); font-size: 0.8rem;">
                                        <th style="padding: 10px;">Spieler</th>
                                        <th style="padding: 10px;" title="Spielzeit">Zeit</th>
                                        <th style="padding: 10px;">Tore</th>
                                        <th style="padding: 10px;">Feld</th>
                                        <th style="padding: 10px;">7m</th>
                                        <th style="padding: 10px;">Fehl</th>
                                        <th style="padding: 10px;">Quote</th>
                                        <th style="padding: 10px;">Gut</th>
                                        <th style="padding: 10px;">BV</th>
                                        <th style="padding: 10px;">SF</th>
                                        <th style="padding: 10px;">Blk</th>
                                        <th style="padding: 10px;">1v1</th>
                                        <th style="padding: 10px;">7m+</th>
                                        <th style="padding: 10px;">2m+</th>
                                        <th style="padding: 10px;">G</th>
                                        <th style="padding: 10px;">2'</th>
                                        <th style="padding: 10px;">R</th>
                                        <th style="padding: 10px;"></th>
                                    </tr>
                                </thead>
                                <tbody id="histHeatmapStatsBodyHome"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="stats-card"
                        style="background: var(--bg-card); border-radius: 12px; padding: 15px; border: 1px solid var(--border-color);">
                        <h2 id="histHeatmapGegnerTitle" class="card-title"
                            style="margin: 0 0 15px 0; font-size: 1.1rem; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
                            Gast</h2>
                        <div class="table-container" style="overflow-x: auto;">
                            <table class="modern-stats-table" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="text-align: left; color: var(--text-muted); font-size: 0.8rem;">
                                        <th style="padding: 10px;">Name</th>
                                        <th style="padding: 10px;" title="Spielzeit">Zeit</th>
                                        <th style="padding: 10px;">Tore</th>
                                        <th style="padding: 10px;">Feld</th>
                                        <th style="padding: 10px;">7m</th>
                                        <th style="padding: 10px;">Fehl</th>
                                        <th style="padding: 10px;">Quote</th>
                                        <th style="padding: 10px;">Gut</th>
                                        <th style="padding: 10px;">BV</th>
                                        <th style="padding: 10px;">SF</th>
                                        <th style="padding: 10px;">Blk</th>
                                        <th style="padding: 10px;">1v1</th>
                                        <th style="padding: 10px;">7m+</th>
                                        <th style="padding: 10px;">2m+</th>
                                        <th style="padding: 10px;">G</th>
                                        <th style="padding: 10px;">2'</th>
                                        <th style="padding: 10px;">R</th>
                                        <th style="padding: 10px;"></th>
                                    </tr>
                                </thead>
                                <tbody id="histHeatmapStatsBodyGegner"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Detail: Protokoll -->
            <div id="histContentProtokoll" class="versteckt">
                <div id="histProtokollAusgabe"
                    style="max-height: 80vh; overflow-y: auto; padding: 15px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border-color);">
                    <!-- Protocol entries will be rendered here -->
                </div>
            </div>

            <!-- Detail: Torfolge -->
            <div id="histContentTorfolge" class="versteckt">
                <div
                    style="max-width: 1200px; min-height: 400px; margin: 0 auto; padding: 20px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border-color);">
                    <canvas id="histTorfolgeChart"></canvas>
                </div>
            </div>
        </div>


        <!-- Video Analyse Bereich -->
        <div id="videoAnalyseBereich" class="versteckt">
            <h2 style="margin-bottom: 20px;">Video Analyse</h2>
            <div style="display: flex; gap: 20px; height: calc(100vh - 120px);">
                <!-- Left: Game List -->
                <div style="width: 320px; display: flex; flex-direction: column; gap: 10px;">
                    <div class="stats-card" style="flex: 1; overflow-y: auto; padding: 15px;">
                        <h3 class="card-title">Spiele</h3>
                        <div id="videoGameListContent" style="display: flex; flex-direction: column; gap: 8px;">
                            <!-- Items injected via JS -->
                            <p style="color: var(--text-muted); font-size: 0.9rem;">Lade Spiele...</p>
                        </div>
                    </div>
                </div>

                <!-- Right: Video Player -->
                <div class="stats-card"
                    style="flex: 1; display: flex; flex-direction: column; gap: 15px; padding: 20px;">
                    <div
                        style="display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
                        <h3 id="videoAnalyseTitle" class="card-title" style="margin: 0; border: none;">Kein Spiel
                            gewählt</h3>
                        <div style="display: flex; gap: 10px;">
                            <button id="setGameStartBtn" class="shadcn-btn-outline compact-btn"
                                title="Aktuelle Video-Position als Spielstart wÃ¤hlen">
                                <i data-lucide="clock" style="width: 14px; height: 14px; margin-right: 5px;"></i>
                                Spielstart setzen
                            </button>
                            <label class="shadcn-btn-primary" style="cursor: pointer;">
                                <i data-lucide="upload" style="width: 16px; height: 16px; margin-right: 8px;"></i>
                                Video laden
                                <input type="file" id="videoFileInput" accept="video/*" style="display: none;">
                            </label>
                        </div>
                    </div>

                    <div style="flex: 1; display: flex; flex-direction: row; gap: 15px; min-height: 0;">
                        <!-- Video Container -->
                        <div
                            style="flex: 2; min-height: 0; background: #000; border-radius: 8px; overflow: hidden; display: flex; align-items: center; justify-content: center; position: relative;">
                            <video id="analysisVideoPlayer" controls
                                style="width: 100%; height: 100%; max-height: 100%;">
                            </video>
                            <div id="videoPlaceholder"
                                style="position: absolute; color: #fff; display: flex; flex-direction: column; align-items: center; gap: 10px; pointer-events: none;">
                                <i data-lucide="film" style="width: 48px; height: 48px; opacity: 0.5;"></i>
                                <span style="opacity: 0.8;">Bitte Video auswählen</span>
                            </div>
                        </div>

                        <!-- Protocol Container -->
                        <div id="videoAnalysisProtocol"
                            style="flex: 1; min-height: 0; overflow-y: auto; background: var(--bg-secondary); border-radius: 8px; padding: 10px; border: 1px solid var(--border-color); display: none; flex-direction: column;">
                            <h3
                                style="font-size: 0.9rem; margin-top: 0; margin-bottom: 8px; position: sticky; top: 0; background: var(--bg-secondary); padding-bottom: 5px; border-bottom: 1px solid var(--border-color); z-index: 5;">
                                Protokoll</h3>
                            <div id="videoAnalysisProtocolList"
                                style="display: flex; flex-direction: column; gap: 4px;">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="aktionsMenue" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3 id="aktionsMenueTitel">Aktion wählen</h3>
                </div>
                <div class="shadcn-modal-body"
                    style="display: flex; flex-direction: column; gap: 8px; margin-top: 1rem;">
                    <button class="shadcn-btn-outline" data-aktion="Tor">Tor</button>
                    <button class="shadcn-btn-outline" data-aktion="Fehlwurf">Fehlwurf</button>
                    <button class="shadcn-btn-outline" data-aktion="7m">7m</button>
                    <button class="shadcn-btn-outline" id="guteAktionModalButton">Anderes</button>
                    <button class="shadcn-btn-outline strafe-gelb" data-aktion="Gelbe Karte">Gelbe Karte</button>
                    <button class="shadcn-btn-outline strafe-zeit" data-aktion="2 Minuten">2 Minuten</button>
                    <button class="shadcn-btn-outline strafe-rot" data-aktion="Rote Karte">Rote Karte</button>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="aktionAbbrechen" style="width: 100%;">Abbrechen</button>
                </div>
            </div>
        </div>

        <div id="aktionVorauswahl" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3>Andere Aktionen</h3>
                </div>
                <div class="shadcn-modal-body"
                    style="display: flex; flex-direction: column; gap: 8px; margin-top: 1rem;">
                    <button class="shadcn-btn-outline" data-aktion="Steal">Steal</button>
                    <button class="shadcn-btn-outline" data-aktion="7M Rausgeholt">7M Rausgeholt</button>
                    <button class="shadcn-btn-outline" data-aktion="TG Pass">TG Pass</button>
                    <button class="shadcn-btn-outline" data-aktion="Assist">Assist</button>
                    <button class="shadcn-btn-outline" data-aktion="Fehlpass">Fehlpass</button>
                    <button class="shadcn-btn-outline" data-aktion="Technischer Fehler">Technischer Fehler</button>
                    <button class="shadcn-btn-outline" data-aktion="Sonstiges">Sonstiges</button>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="aktionVorauswahlAbbrechen"
                        style="width: 100%;">Zurück</button>
                </div>
            </div>
        </div>

        <!-- Comment Modal (Shadcn Style) -->
        <div id="kommentarBereich" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3 id="kommentarTitel">Kommentar (optional)</h3>
                </div>
                <div class="shadcn-modal-body"
                    style="margin-top: 1rem; display: flex; flex-direction: column; gap: 8px;">
                    <input type="text" id="kommentarInput" placeholder="Beschreibe die Aktion..." class="shadcn-input">
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-primary" id="kommentarSpeichernButton">Speichern</button>
                </div>
            </div>
        </div>


        <!-- Wurfbild Modal (Shadcn Style) -->
        <div id="wurfbildModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3 id="wurfbildTitel">Wo ging der Ball rein?</h3>
                </div>
                <!-- Content (Goal SVG) -->
                <div id="wurfbildUmgebung" style="margin-top: 1rem; display: flex; justify-content: center;">
                    <svg id="inputGoalSvg" viewBox="0 0 300 200"
                        style="width: 100%; height: auto; max-width: 400px; display: block; margin: 0 auto; background-color: transparent;">
                        <!-- Goal Frame (Matches Heatmap) -->
                        <rect x="25" y="10" width="250" height="180" fill="none" stroke="#888" stroke-width="3" />
                        <line x1="100" y1="10" x2="100" y2="190" stroke="#bbb" stroke-width="1"
                            stroke-dasharray="5,5" />
                        <line x1="200" y1="10" x2="200" y2="190" stroke="#bbb" stroke-width="1"
                            stroke-dasharray="5,5" />
                        <line x1="25" y1="70" x2="275" y2="70" stroke="#bbb" stroke-width="1" stroke-dasharray="5,5" />
                        <line x1="25" y1="130" x2="275" y2="130" stroke="#bbb" stroke-width="1"
                            stroke-dasharray="5,5" />
                    </svg>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="wurfbildUeberspringen">Überspringen</button>
                </div>
            </div>
        </div>

        <!-- Wurfposition Modal (Shadcn Style) -->
        <div id="wurfpositionModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3>Von wo wurde geworfen?</h3>
                </div>
                <div id="wurfpositionFeld" style="margin-top: 1rem; display: flex; justify-content: center;">
                    <svg viewBox="0 0 300 400" width="100%" style="max-height: 50vh;">
                        <!-- Spielfeld Hälfte (Matching Heatmap Output) -->
                        <rect x="10" y="10" width="280" height="380" fill="#f5f5f5" stroke="#333" stroke-width="2" />

                        <!-- Tor oben (Mitte) -->
                        <rect x="112" y="10" width="76" height="8" fill="#333" />

                        <!-- 6m Linie (Torraum - durchgezogen) -->
                        <path d="M 75 18 Q 75 90 150 90 Q 225 90 225 18" fill="none" stroke="#333" stroke-width="2" />

                        <!-- 9m Linie (Freiwurflinie - gestrichelt) -->
                        <path d="M 37 18 Q 37 150 150 150 Q 263 150 263 18" fill="none" stroke="#333" stroke-width="1"
                            stroke-dasharray="6,3" />

                        <!-- 7m Punkt -->
                        <circle cx="150" cy="65" r="4" fill="#333" />

                        <!-- Mittellinie -->
                        <line x1="10" y1="388" x2="290" y2="388" stroke="#333" stroke-width="2" />
                    </svg>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="wurfpositionUeberspringen">Überspringen</button>
                </div>
            </div>
        </div>

        <!-- Opponent Number Modal (Shadcn Style) -->
        <div id="gegnerNummerModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3 id="gegnerNummerTitel">Torschütze (Gast)</h3>
                </div>
                <div class="shadcn-modal-body" style="margin-top: 1rem;">
                    <div id="bekannteGegnerListe"
                        style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 1rem;">
                    </div>
                    <div
                        style="border-top: 1px solid hsl(var(--border)); padding-top: 10px; display: flex; flex-direction: column; gap: 10px;">
                        <input type="number" id="neueGegnerNummer" placeholder="Neue Nummer" class="shadcn-input">
                        <input type="text" id="neueGegnerName" placeholder="Name (optional)" class="shadcn-input">
                        <label class="shadcn-checkbox-label"
                            style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem; cursor: pointer; margin-top: 5px;">
                            <input type="checkbox" id="neueGegnerTorwart" style="cursor: pointer;">
                            <span>Torwart (TW)</span>
                        </label>
                    </div>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="gegnerNummerUeberspringen">Unbekannt / Weiter</button>
                    <button class="shadcn-btn-primary" id="gegnerNummerSpeichern">Weiter</button>
                </div>
            </div>
        </div>

        <!-- Quick Add Home Player Modal (during game) -->
        <!-- Quick Add Home Player Modal (Shadcn Style) -->
        <div id="quickAddPlayerModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3>Spieler hinzufügen</h3>
                    <p>Nummer und optional Name eingeben:</p>
                </div>
                <div class="shadcn-modal-body"
                    style="display: flex; flex-direction: column; gap: 10px; margin-top: 1rem;">
                    <input type="number" id="quickPlayerNumber" placeholder="Nummer" class="shadcn-input">
                    <input type="text" id="quickPlayerName" placeholder="Name (optional)" class="shadcn-input">
                    <label class="shadcn-checkbox-label"
                        style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem; cursor: pointer; margin-top: 5px;">
                        <input type="checkbox" id="quickPlayerTorwart" style="cursor: pointer;">
                        <span>Torwart (TW)</span>
                    </label>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="quickAddPlayerCancel">Abbrechen</button>
                    <button class="shadcn-btn-primary" id="quickAddPlayerSave">Hinzufügen</button>
                </div>
            </div>
        </div>

        <!-- Save Team Name Modal -->
        <!-- Save Team Name Modal (Shadcn Style) -->
        <div id="saveTeamNameModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3>Team speichern</h3>
                    <p>Gib einen Namen für das Team ein:</p>
                </div>
                <div class="shadcn-modal-body" style="margin-top: 1rem;">
                    <input type="text" id="saveTeamNameInput" placeholder="Team Name" class="shadcn-input">
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="saveTeamNameCancel">Abbrechen</button>
                    <button class="shadcn-btn-primary" id="saveTeamNameConfirm">Speichern</button>
                </div>
            </div>
        </div>

        <!-- View/Edit Team Modal -->
        <!-- View/Edit Team Modal (Shadcn Style) -->
        <div id="viewTeamModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content" style="max-width: 600px;">
                <div class="shadcn-modal-header">
                    <h3 id="viewTeamTitle">Team anschauen</h3>
                </div>
                <div class="shadcn-modal-body" style="margin-top: 1rem;">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Team Name:</label>
                        <input type="text" id="editTeamNameInput" placeholder="Team Name" class="shadcn-input">
                    </div>
                    <div id="viewTeamPlayersList" style="max-height: 300px; overflow-y: auto; margin: 15px 0;">
                        <!-- Players will be listed here -->
                    </div>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="viewTeamClose" style="flex: 1;">Schließen</button>
                    <button class="shadcn-btn-primary" id="saveTeamChanges"
                        style="flex: 1; background-color: #28a745;">Änderungen speichern</button>
                </div>
            </div>
        </div>

        <!-- Season Overview Modal -->
        <!-- Season Overview Modal (Shadcn Style) -->
        <div id="seasonOverviewModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content"
                style="max-width: 900px; max-height: 90vh; display: flex; flex-direction: column;">
                <div class="shadcn-modal-header">
                    <h2>Saison-Übersicht</h2>
                </div>
                <div class="shadcn-modal-body" style="overflow-y: auto; flex: 1;">
                    <div id="seasonSummary"
                        style="margin: 15px 0; padding: 10px; background-color: var(--bg-secondary); border-radius: 5px;">
                        <!-- Summary stats -->
                    </div>
                    <div id="seasonStatsContainer" style="margin-top: 20px;">
                        <!-- Player cards will be rendered here -->
                    </div>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="seasonOverviewClose">Schließen</button>
                </div>
            </div>
        </div>



        <!-- Load Team Modal -->
        <!-- Load Team Modal (Shadcn Style) -->
        <div id="loadTeamModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3>Gespeicherte Teams</h3>
                </div>
                <div class="shadcn-modal-body">
                    <div id="savedTeamsList" style="max-height: 300px; overflow-y: auto; margin: 15px 0;">
                        <!-- Teams will be listed here -->
                    </div>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="loadTeamCancel">Abbrechen</button>
                </div>
            </div>
        </div>

        <!-- Add Opponent Modal (Shadcn Style) -->
        <div id="addGegnerModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3>Gegner hinzufügen</h3>
                    <p>Gib die Nummer und optional den Namen ein:</p>
                </div>
                <div class="shadcn-modal-body"
                    style="display: flex; flex-direction: column; gap: 10px; margin-top: 1rem;">
                    <input type="number" id="addGegnerNummerInput" placeholder="Nummer" class="shadcn-input">
                    <input type="text" id="addGegnerNameInput" placeholder="Name (optional)" class="shadcn-input">
                    <label class="shadcn-checkbox-label"
                        style="display: flex; align-items: center; gap: 8px; font-size: 0.9rem; cursor: pointer; margin-top: 5px;">
                        <input type="checkbox" id="addGegnerTorwartInput" style="cursor: pointer;">
                        <span>Torwart (TW)</span>
                    </label>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="addGegnerAbbrechen">Abbrechen</button>
                    <button class="shadcn-btn-primary" id="addGegnerSpeichern">Hinzufügen</button>
                </div>
            </div>
        </div>

        <!-- 7m Outcome Modal (Shadcn Style) -->
        <div id="sevenMeterOutcomeModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3>7m Ergebnis</h3>
                </div>
                <div class="shadcn-modal-body"
                    style="display: flex; flex-direction: column; gap: 8px; margin-top: 1rem;">
                    <button class="shadcn-btn-primary" data-outcome="Tor">Tor</button>
                    <button class="shadcn-btn-outline" data-outcome="Gehalten">Gehalten</button>
                    <button class="shadcn-btn-outline" data-outcome="Verworfen">Verworfen (Pfosten/Aus)</button>
                </div>
                <!-- No footer needed if actions are definitive, or add cancel if desired. Default existing didn't have explicit cancel -->
            </div>
        </div>

        <!-- Wurfbilder Stats Modal (Shadcn Style) -->
        <div id="wurfbilderStatsModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content" style="max-width: 500px; width: 95%;">
                <div class="shadcn-modal-header">
                    <h3>Wurfbilder Übersicht</h3>
                </div>
                <div class="shadcn-modal-body">
                    <div id="wurfbilderContainer" style="max-height: 60vh; overflow-y: auto;"></div>
                </div>
                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="closeWurfbilderStats">Schließen</button>
                </div>
            </div>
        </div>

        <!-- Live Game Overview Modal (Shadcn Style) -->
        <div id="liveGameOverviewModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content"
                style="max-width: 900px; width: 95%; max-height: 90vh; display: flex; flex-direction: column;">
                <div class="shadcn-modal-header">
                    <h3>Spiel Übersicht (Aktuell)</h3>
                </div>
                <!-- Body needs to scroll -->
                <div class="shadcn-modal-body" style="overflow-y: auto; flex: 1;">
                    <!-- Score Header -->
                    <div class="live-overview-score-header"
                        style="margin-bottom: 24px; text-align: center; background: hsl(var(--muted)/0.3); padding: 20px; border-radius: 12px; border: 1px solid hsl(var(--border));">
                        <div style="display: flex; justify-content: space-around; align-items: center; gap: 20px;">
                            <div style="flex: 1;">
                                <div id="liveOverviewTeamHeim"
                                    style="font-size: 1.1rem; font-weight: 600; color: hsl(var(--primary));">HEIM
                                </div>
                            </div>
                            <div
                                style="font-size: 2.5rem; font-weight: 800; letter-spacing: -1px; min-width: 120px; display: flex; justify-content: center; align-items: center; gap: 8px;">
                                <span id="liveOverviewScoreHeim">0</span>
                                <span style="color: hsl(var(--muted-foreground)); opacity: 0.5;">:</span>
                                <span id="liveOverviewScoreGegner">0</span>
                            </div>
                            <div style="flex: 1;">
                                <div id="liveOverviewTeamGegner"
                                    style="font-size: 1.1rem; font-weight: 600; color: #ef4444;">GEGNER</div>
                            </div>
                        </div>
                        <div id="liveOverviewTime"
                            style="margin-top: 8px; font-size: 0.9rem; font-weight: 500; color: hsl(var(--muted-foreground)); font-family: monospace;">
                            00:00</div>
                    </div>

                    <!-- Tabs -->
                    <div class="heatmap-tabs">
                        <button class="heatmap-tab shadcn-btn-outline active"
                            id="liveOverviewTabStats">Statistik</button>
                        <button class="heatmap-tab shadcn-btn-outline" id="liveOverviewTabHeatmap">Heatmap</button>
                    </div>

                    <!-- Content: Stats -->
                    <div id="liveOverviewContentStats">
                        <!-- Heim Stats Card -->
                        <div
                            style="background: var(--bg-container); border-radius: 12px; padding: 15px; border: 1px solid var(--border-color); margin-bottom: 20px; min-width: 0;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
                                <h4 id="liveOverviewTeamHeimTitle"
                                    style="margin: 0; font-size: 1.1rem; color: var(--team-primary-color);">Heim</h4>
                            </div>
                            <div style="overflow-x: auto; display: block; width: 100%; max-width: 100%;">
                                <table class="modern-stats-table"
                                    style="display: block; width: max-content !important; min-width: 800px !important; border-collapse: collapse;">
                                    <thead>
                                        <tr style="text-align: left; color: var(--text-muted); font-size: 0.75rem;">
                                            <th style="padding: 8px;">SPIELER</th>
                                            <th style="padding: 8px;">ZEIT</th>
                                            <th style="padding: 8px;">TORE</th>
                                            <th style="padding: 8px;">FELD</th>
                                            <th style="padding: 8px;">7m</th>
                                            <th style="padding: 8px;">FEHL</th>
                                            <th style="padding: 8px;">QUOTE</th>
                                            <th style="padding: 8px;">BALL</th>
                                            <th style="padding: 8px;">FOUL</th>
                                            <th style="padding: 8px;">BLK</th>
                                            <th style="padding: 8px;">1v1+</th>
                                            <th style="padding: 8px;">1v1-</th>
                                            <th style="padding: 8px;">7m+</th>
                                            <th style="padding: 8px;">2m+</th>
                                            <th style="padding: 8px;">G</th>
                                            <th style="padding: 8px;">2'</th>
                                            <th style="padding: 8px;">R</th>
                                        </tr>
                                    </thead>
                                    <tbody id="liveOverviewStatsBody" style="font-size: 0.85rem;"></tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Gegner Stats Card -->
                        <div
                            style="background: var(--bg-container); border-radius: 12px; padding: 15px; border: 1px solid var(--border-color); min-width: 0;">
                            <div
                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; border-bottom: 1px solid var(--border-color); padding-bottom: 10px;">
                                <h4 id="liveOverviewTeamGegnerTitle"
                                    style="margin: 0; font-size: 1.1rem; color: var(--team-opponent-color);">Gegner</h4>
                            </div>
                            <div style="overflow-x: auto; display: block; width: 100%; max-width: 100%;">
                                <table class="modern-stats-table"
                                    style="display: block; width: max-content !important; min-width: 800px !important; border-collapse: collapse;">
                                    <thead>
                                        <tr style="text-align: left; color: var(--text-muted); font-size: 0.75rem;">
                                            <th style="padding: 8px;">SPIELER</th>
                                            <th style="padding: 8px;">ZEIT</th>
                                            <th style="padding: 8px;">TORE</th>
                                            <th style="padding: 8px;">FELD</th>
                                            <th style="padding: 8px;">7m</th>
                                            <th style="padding: 8px;">FEHL</th>
                                            <th style="padding: 8px;">QUOTE</th>
                                            <th style="padding: 8px;">BALL</th>
                                            <th style="padding: 8px;">FOUL</th>
                                            <th style="padding: 8px;">BLK</th>
                                            <th style="padding: 8px;">1v1+</th>
                                            <th style="padding: 8px;">1v1-</th>
                                            <th style="padding: 8px;">7m+</th>
                                            <th style="padding: 8px;">2m+</th>
                                            <th style="padding: 8px;">G</th>
                                            <th style="padding: 8px;">2'</th>
                                            <th style="padding: 8px;">R</th>
                                        </tr>
                                    </thead>
                                    <tbody id="liveOverviewStatsGegnerBody" style="font-size: 0.85rem;"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Content: Heatmap -->
                    <div id="liveOverviewContentHeatmap" class="versteckt" style="text-align: center;">
                        <div class="heatmap-tabs" style="margin-top: 10px;">
                            <button class="heatmap-tab shadcn-btn-outline active"
                                id="liveOverviewSubTabTor">Tor</button>
                            <button class="heatmap-tab shadcn-btn-outline" id="liveOverviewSubTabFeld">Feld</button>
                            <button class="heatmap-tab shadcn-btn-outline"
                                id="liveOverviewSubTabKombi">Kombiniert</button>
                        </div>
                        <!-- Filters reuse history filters logic or new ones? -->
                        <!-- We can reuse IDs if we are careful, but better to use unique IDs and unified event handling -->
                        <div class="heatmap-filter">
                            <label><input type="radio" name="liveOverviewHeatTeam" value="heim" checked>
                                Heim</label>
                            <label><input type="radio" name="liveOverviewHeatTeam" value="gegner"> Gegner</label>
                            <span style="margin: 0 10px;">|</span>
                            <label><input type="checkbox" id="liveOverviewHeatmapToreFilter" checked>
                                Feldtore</label>
                            <label><input type="checkbox" id="liveOverviewHeatmap7mFilter"> 7m</label>
                            <label><input type="checkbox" id="liveOverviewHeatmapMissedFilter" checked>
                                Fehlwürfe</label>
                        </div>
                        <div id="liveOverviewHeatmapContainer"
                            style="display: flex; justify-content: center; padding: 20px;">
                            <svg id="liveOverviewHeatmapSvg" viewBox="0 0 300 200" width="600" height="400"
                                style="margin: 0 auto; display: block;"></svg>
                        </div>
                    </div>

                </div>

                <div class="shadcn-modal-footer">
                    <button class="shadcn-btn-outline" id="closeLiveGameOverview">Schließen</button>
                </div>
            </div>
        </div>


        <!-- Custom Confirm/Alert Modal -->
        <!-- Custom Confirm/Alert Modal (Shadcn Style) -->
        <div id="customConfirmModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3 id="customConfirmTitle">Bestätigung</h3>
                    <p id="customConfirmMessage"></p>
                </div>
                <div class="shadcn-modal-footer">
                    <button id="customConfirmNo" class="shadcn-btn-outline">Abbrechen</button>
                    <button id="customConfirmYes" class="shadcn-btn-primary">Fortfahren</button>
                </div>
            </div>
        </div>

        <!-- Custom Alert Modal (nur OK Button) -->
        <!-- Custom Alert Modal (Shadcn Style) -->
        <div id="customAlertModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3 id="customAlertTitle">Hinweis</h3>
                    <p id="customAlertMessage"></p>
                </div>
                <div class="shadcn-modal-footer">
                    <button id="customAlertOk" class="shadcn-btn-primary"
                        style="width: 100%; max-width: 100px;">OK</button>
                </div>
            </div>
        </div>

        <!-- Custom Prompt Modal (Input) -->
        <div id="customPromptModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3 id="customPromptTitle">Eingabe</h3>
                    <p id="customPromptMessage"></p>
                </div>
                <div class="shadcn-modal-body">
                    <input type="text" id="customPromptInput" class="shadcn-input" placeholder="Text eingeben..."
                        style="width: 100%; box-sizing: border-box;">
                </div>
                <div class="shadcn-modal-footer">
                    <button id="customPromptCancel" class="shadcn-btn-secondary">Abbrechen</button>
                    <button id="customPromptConfirm" class="shadcn-btn-primary">Bestätigen</button>
                </div>
            </div>
        </div>

        <!-- Load Play Modal -->
        <div id="loadPlayModal" class="modal-overlay versteckt">
            <div class="shadcn-modal-content">
                <div class="shadcn-modal-header">
                    <h3>Spielzug laden</h3>
                    <button id="closeLoadPlayModal" class="close-modal-btn">&times;</button>
                </div>
                <div class="shadcn-modal-body">
                    <div id="loadPlayList" class="play-list-container"
                        style="display: flex; flex-direction: column; gap: 0.5rem; max-height: 300px; overflow-y: auto;">
                        <!-- Plays will be populated here -->
                    </div>
                </div>
            </div>
        </div>

    </div> <!-- End of main-content -->

    <!-- Attributed Player Modal (for Blocked Shot / Provoked fouls) -->
    <div id="attributedPlayerModal" class="modal-overlay versteckt">
        <div class="shadcn-modal-content" style="max-width: 600px;">
            <div class="shadcn-modal-header">
                <h3 id="attributedPlayerTitle">Spieler auswählen</h3>
                <p id="attributedPlayerSubtitle">Wer war beteiligt?</p>
            </div>
            <div class="shadcn-modal-body" style="margin-top: 1rem;">
                <div id="attributedPlayerList"
                    style="display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 10px; max-height: 400px; overflow-y: auto; padding: 5px;">
                    <!-- Players of the other team will be rendered here -->
                </div>
            </div>
            <div class="shadcn-modal-footer">
                <button class="shadcn-btn-outline" id="attributedPlayerCancel">Überspringen / Abbrechen</button>
            </div>
        </div>
    </div>

    <script type="module" src="main.js"></script>
    <script>
        // Initialize Lucide Icons
        if (typeof lucide !== 'undefined') {
            lucide.createIcons();
        } else {
            window.addEventListener('load', () => {
                if (typeof lucide !== 'undefined') lucide.createIcons();
            });
        }
    </script>
</body>

</html>